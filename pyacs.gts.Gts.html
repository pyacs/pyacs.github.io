

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyacs.gts.Gts module &mdash; PYACS 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyacs.gts.Sgts module" href="pyacs.gts.Sgts.html" />
    <link rel="prev" title="pyacs.gts.lib.trajectory module" href="pyacs.gts.lib.trajectory.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PYACS
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="foreword.html">What is pyacs?</a></li>
<li class="toctree-l1"><a class="reference internal" href="foreword.html#the-philosophy-of-pyacs">The philosophy of pyacs</a></li>
<li class="toctree-l1"><a class="reference internal" href="foreword.html#the-components-of-pyacs">The components of pyacs</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">How to install pyacs?</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_cluster_processing.html">pygeca: GNSS cluster processing with GAMIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_gts.html">Getting started GPS time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_inversion.html">Getting started slip inversion</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyacs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pyacs.html">pyacs package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pyacs.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="pyacs.gts.html">pyacs.gts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyacs.lib.html">pyacs.lib package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyacs.sinex.html">pyacs.sinex package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyacs.sol.html">pyacs.sol package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyacs.html#module-pyacs">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PYACS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">pyacs</a> &raquo;</li>
        
          <li><a href="pyacs.html">pyacs package</a> &raquo;</li>
        
          <li><a href="pyacs.gts.html">pyacs.gts package</a> &raquo;</li>
        
      <li>pyacs.gts.Gts module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyacs.gts.Gts.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pyacs.gts.Gts">
<span id="pyacs-gts-gts-module"></span><h1>pyacs.gts.Gts module<a class="headerlink" href="#module-pyacs.gts.Gts" title="Permalink to this headline">¶</a></h1>
<p>Geodetic Time Series Class &amp; methods</p>
<p>A Geodetic time series (Gts) is a series of 3 components North,East,UP as a function of increasing dates</p>
<p>The Gts implemented in PYACS has the following structure:</p>
<dl class="simple">
<dt>Basic data</dt><dd><ul class="simple">
<li><p>data:            a 2D numpy array with 7 columns including: dec.year, N, E, U, S_N, S_E, S_U</p></li>
<li><p>code:            station 4-letters code</p></li>
<li><p>lon,lat,h:       approximate longitude, latitude (geodetic, deg.dec) and ellipsoidal height (m)</p></li>
<li><p>X0,Y0,Z0         XYZ reference position in the Geocentric Frame. N,E,U are with respect to X0,Y0,Z0</p></li>
<li><p>t0               reference date in decimal year corresponding to the X0,Y0,Z0</p></li>
</ul>
</dd>
<dt>Optional data</dt><dd><ul class="simple">
<li><p>data_xyz:        a 2D numpy array with 7 columns including: dec.year, X, Y, Z, SX, SY, SZ, corr_XY, corr_XZ, corr_YZ</p></li>
<li><p>data_corr_neu    a 2D numpy array with 4 columns including: dec.year, corr_ne,corr_nu,corr_eu</p></li>
<li><p>data_corr_xyz    a 2D numpy array with 4 columns including: dec.year, corr_xy,corr_xz,corr_yz</p></li>
</ul>
</dd>
<dt>Analysis results</dt><dd><ul class="simple">
<li><p>outliers:        list of index of outliers in a time series (all components)</p></li>
<li><p>outliers_east    list of index of outliers on the East component in a time series</p></li>
<li><p>outliers_north   list of index of outliers on the North component in a time series</p></li>
<li><p>outliers_up      list of index of outliers on the Up component in a time series</p></li>
<li><p>offsets_values:  a 2D numpy array with 7 columns: dec.year N, E, U, S_N, S_E, S_U</p></li>
<li><p>offsets_dates:   a list of dates for offsets</p></li>
<li><p>velocity:        a 1D numpy array with 6 columns: vel_N, vel_E, vel_U, S_vel_N, S_vel_E, S_vel_U</p></li>
<li><p>annual:          a 1D numpy array with 6 columns: Amplitude_N, Phase_N, Amplitude_E, Phase_E, Amplitude_U, Phase_U</p></li>
<li><p>semi_annual:     a 1D numpy array with 6 columns: Amplitude_N, Phase_N, Amplitude_E, Phase_E, Amplitude_U, Phase_U</p></li>
</ul>
</dd>
<dt>Metadata</dt><dd><ul class="simple">
<li><p>ifile:          original input file of the time series</p></li>
<li><p>log:            log of operations</p></li>
<li><p>metadata:       any information the analyst would like to be recorded</p></li>
</ul>
</dd>
<dt>Units Conventions</dt><dd><ul class="simple">
<li><p>dates are in decimal year</p></li>
<li><p>coordinates are in meters</p></li>
<li><p>phases are in radians</p></li>
</ul>
</dd>
<dt>Programming conventions</dt><dd><ul class="simple">
<li><p>singular denotes single values, plural or name starting with l denotes lists or array</p></li>
<li><p>in_place=True in methods means that current content of the Gts will be overwritten; default is False</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt id="pyacs.gts.Gts.get_index_from_dates">
<code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">get_index_from_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dates</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.25</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#get_index_from_dates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyacs.gts.Gts.get_index_from_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the list of index in data corresponding to given dates within tolerance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> – list of dates in decimal year</p></li>
<li><p><strong>data</strong> – a 2D numpy array with decimal dates in the first column</p></li>
<li><p><strong>tol</strong> – date tolerance to decide that two dates are equal. (default 0.25 day)</p></li>
</ul>
</dd>
</dl>
<p>:return : list of index</p>
</dd></dl>

<dl class="py class">
<dt id="pyacs.gts.Gts.Gts">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyacs.gts.Gts.Gts" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read">
<em class="property">classmethod </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsfile</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyacs.gts.Gts.Gts.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a time series file</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_obs">
<code class="sig-name descname">add_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">NEUSNSESUCNECNUCEU</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">check</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds observation(s) as DN,DE,DU to a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year. float, a list or 1D numpy array</p></li>
<li><p><strong>NEUSNSESUCNECNUCEU</strong> – value to be added in the Gts, provided as a list, a 1D numpy array or a 2D numpy array.
requires at least NEU: North, East, UP values
optional: SN, SE, SU, CNE, CNU, CEU: standard deviations and correlation coefficient between North, East and Up components.
If not provided, SN=SE=SU=0.001 (1 mm) and CNE=CNU=CEU=0</p></li>
<li><p><strong>in_place</strong> – boolean, if True add_obs to the current Gts, if False, returns a new Gts</p></li>
<li><p><strong>check</strong> – check time order and duplicate dates</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts or the modified Gts if in_place
:note : if it exists, .data_xyz will be set to None for consistency.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_obs_xyz">
<code class="sig-name descname">add_obs_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">XYZSXSYSZCXYCXZCYZ</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">check</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">neu</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_obs_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds observation(s) as XYZ to a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year. float, a list or 1D numpy array</p></li>
<li><p><strong>XYZSXSYSZCXYCXZCYZ</strong> – value to be added in the Gts, provided as a list, a 1D numpy array or a 2D numpy array.    requires at least X,Y,Z</p></li>
</ul>
</dd>
</dl>
<p>optional: SX, SY, SZ, CXY, CXZ, CYZ: standard deviations and correlation coefficients.    If not provided, SX=SY=SZ=0.001 (1 mm) and CXY=CXZ=CYZ=0
:param in_place: boolean, if True add_obs to the current Gts, if False, returns a new Gts
:param check: check time order , duplicate dates and re-generate NEU time series (.data)
:param neu: regenerate .data from the updated .data_xyz
:param verbose: verbose mode</p>
<p>:return : new Gts or the modified Gts if in_place
:note 1: by default .data will be updated from .data_xyz, and X0,Y0,Z0 will be updated.
:note 2:</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_offsets_dates">
<code class="sig-name descname">add_offsets_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offsets_dates</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_offsets_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>add_offsets_dates to a time series
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_vel_sigma">
<code class="sig-name descname">add_vel_sigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">b_fn</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_vel_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates realistic sigma on velocity components assuming white &amp;  
flicker using eq (19) &amp; (23) from Williams (J. of Geodesy, 2003)
b_fn is the value for flicker noise, taken as 4 mm/yr^1/4
model can be detrend, detrend_annual, detrend_seasonal 
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.apply_offsets">
<code class="sig-name descname">apply_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">np_offset</span></em>, <em class="sig-param"><span class="n">opposite</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.apply_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies given offsets to a times series
np_offset is a 1D np.array with lines [dates,north,east,up]
if in_place = True then replace the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>np_offset</strong> – 1D or 3D numpy array or list or list of list with column offset_dates, north, east, up, s_north, s_east, s_up</p></li>
<li><p><strong>opposite</strong> – boolean, if True apply the oppsite of provided offsets</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.cdata">
<code class="sig-name descname">cdata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.cdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Check data/data_xyz attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – boolean, if True, data attribute will be checked</p></li>
<li><p><strong>data_xyz</strong> – boolean, if True, data_xyz attribute will be checked</p></li>
<li><p><strong>tol</strong> – tolerance in days for two dates to be considered as the same (default 0.001 of day)</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : boolean, True if everything is OK, False otherwise</p>
<p>:note : in future, this routine should also whether .data and .data_xyz value are consistent</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">loutliers</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>makes a (deep) copy of the time series.</p>
<p>By default, all attributes are also copied, including .data, .data_xyz, loutliers etc.</p>
<p>Default behaviour can be modified for the following attribute:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – can be set to None or a 2D numpy array of shape (n,10)</p></li>
<li><p><strong>data_xyz</strong> – can be set to None or a 2D numpy array of shape (n,10)</p></li>
<li><p><strong>loutliers</strong> – False will not copy the loutliers atrribute</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.correct_duplicated_dates">
<code class="sig-name descname">correct_duplicated_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">action</span><span class="o">=</span><span class="default_value">'correct'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.correct_duplicated_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Check or remove duplicated dates in a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> – ‘correct’ (default) or ‘check’</p></li>
<li><p><strong>tol</strong> – tolerance for two dates to be considered as the same (default = 0.1 day)</p></li>
<li><p><strong>in_place</strong> – boolean, if True,</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.decimate">
<code class="sig-name descname">decimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_step</span><span class="o">=</span><span class="default_value">30.0</span></em>, <em class="sig-param"><span class="n">dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>decimate a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_step</strong> – time step in days</p></li>
<li><p><strong>dates</strong> – list of dates where point are forced to be written regardless time_step</p></li>
<li><p><strong>method</strong> – method used to be used to calculated the position. choose among [‘median’,’mean’,’exact’]</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.decyear2days">
<code class="sig-name descname">decyear2days</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ref_date</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.decyear2days" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the dates of a time series from decimal years to days after a reference date
ref_date is read by guess_date</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.delete_small_offsets">
<code class="sig-name descname">delete_small_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offsets</span></em>, <em class="sig-param"><span class="n">del_by_pricise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.delete_small_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>The aim for test_offset modul. 
Estimate the offsets with clean data.
Then delete the offsets which their values are so small
input: list of time offsets
output: list of time offsets tested</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend">
<code class="sig-name descname">detrend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend" title="Permalink to this definition">¶</a></dt>
<dd><p>detrends a time series and save velocity estimates in velocity attribute</p>
<p>:param periods         : periods used to estimate the velocity
:param exclude_periods : periods to be excluded for the velocity estimate
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are omitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_annual">
<code class="sig-name descname">detrend_annual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_annual" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates a trend + annual terms in a time series and removes them
velocity and annual attribute are saved in Gts.velocity &amp; Gts.annual</p>
<p>:param periods         : periods used for estimation
:param exclude_periods : periods to be excluded from estimation
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are ommitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_median">
<code class="sig-name descname">detrend_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta_day</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">auto</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a velocity using the median of pair of displacements exactly separated by one year, inspired from MIDAS
If the time series has less than a year of data, then the time series is kept untouched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta_day</strong> – if None, it is one year, if 0 then it is the relax mode for campaign data, 
any integer is the time delta (in days) used to compute velocity.</p></li>
<li><p><strong>in_place</strong> – boolean, if True, in_place, if False, returns a new Gts instance (default)</p></li>
<li><p><strong>periods</strong> – periods (list of lists) to be included for trend calculation</p></li>
<li><p><strong>exclude_periods</strong> – periods (list of lists) to be excluded for trend calculation</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
<li><p><strong>auto</strong> – if True, then start will delta_day=None, if it fails or found less than 100 pairs then use delta_day=0,</p></li>
</ul>
</dd>
</dl>
<p>if fails then use regular detrend</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>returns None if time series is shorter than 1 year</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_seasonal">
<code class="sig-name descname">detrend_seasonal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_seasonal" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates a trend + annual + semi-annual terms in a time series and removes them
velocity, annual and semi-annual attributes are saved in Gts.velocity, Gts.annual, Gts.semi_annual</p>
<p>:param periods         : periods used for estimation
:param exclude_periods : periods to be excluded from estimation
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are ommitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_seasonal_median">
<code class="sig-name descname">detrend_seasonal_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wl</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_seasonal_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a velocity using the median of pair of displacements exactly separated by one year, inspired from MIDAS and then removes repeating yearly signal
If the time series has less than three years of data, then the time series is kept untouched.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.differentiate">
<code class="sig-name descname">differentiate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.differentiate" title="Permalink to this definition">¶</a></dt>
<dd><p>differentiate the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the differentiated time series as a new Gts object</p>
</dd>
</dl>
<p>:note : differentiation is made on .data. .data_xyz is set to None.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.displacement">
<code class="sig-name descname">displacement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sdate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">speriod</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">eperiod</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">rounding</span><span class="o">=</span><span class="default_value">'day'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates displacements between two dates or two periods</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – start date in decimal year</p></li>
<li><p><strong>edate</strong> – start date in decimal year</p></li>
<li><p><strong>window</strong> – time window in days for searching available dates</p></li>
<li><p><strong>method</strong> – method to calculate the position. ‘median’ or ‘mean’. default is ‘median’.</p></li>
<li><p><strong>speriod</strong> – period for calculating the start position</p></li>
<li><p><strong>eperiod</strong> – period for calculating the end position</p></li>
<li><p><strong>rounding</strong> – rounding for dates. Choose among ‘day’,’hour’,’minute’ or ‘second’. default is ‘day’.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>displacement as np.array([dn,de,du,sdn,sde,sdu])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.edge_filter">
<code class="sig-name descname">edge_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lbda</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.edge_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge Gts filter using a L1 total variation filter.
The signal is assumed to be piecewise constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lbda</strong> – lambda parameter</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
<dt class="field-odd">Reference</dt>
<dd class="field-odd"><p><a class="reference external" href="https://github.com/albarji/proxTV">https://github.com/albarji/proxTV</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.estimate_local_offset">
<code class="sig-name descname">estimate_local_offset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.estimate_local_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the local offset, just used window_length positions before &amp; window_length positions behind of offset
output: amplitude of local offsets</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.exclude_periods">
<code class="sig-name descname">exclude_periods</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lperiod</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.exclude_periods" title="Permalink to this definition">¶</a></dt>
<dd><p>exclude periods of a Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lperiod</strong> – a list [start_date,end_date] or a list of periods e.g. periods=[[2000.1,2003.5],[2009.3,2010.8]]</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
</ul>
</dd>
<dt class="field-even">Note 1</dt>
<dd class="field-even"><p>X0,Y0,Z0 attributes will be changed if necessary</p>
</dd>
<dt class="field-odd">Note 2</dt>
<dd class="field-odd"><p>handles both .data and .data_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_dates">
<code class="sig-name descname">extract_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dates</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a time series extracted for a given list of dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> – dates either as a list or  1D numpy array of decimal dates</p></li>
<li><p><strong>tol</strong> – date tolerance in days to assert that two dates are equal (default 0.05 day)</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_after_date">
<code class="sig-name descname">extract_ndates_after_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_after_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values after a given date
If n values are not available, returns all available values after date
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_around_date">
<code class="sig-name descname">extract_ndates_around_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_around_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values before and n values after a given date
If n values are not available, returns all available values
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_before_date">
<code class="sig-name descname">extract_ndates_before_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_before_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values before a given date
If n values are not available, returns all available values before date
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_periods">
<code class="sig-name descname">extract_periods</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lperiod</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_periods" title="Permalink to this definition">¶</a></dt>
<dd><p>extract periods of a Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lperiod</strong> – a list [start_date,end_date] or a list of periods e.g. periods=[[2000.1,2003.5],[2009.3,2010.8]]</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
</ul>
</dd>
<dt class="field-even">Note 1</dt>
<dd class="field-even"><p>X0,Y0,Z0 attributes will be changed if necessary</p>
</dd>
<dt class="field-odd">Note 2</dt>
<dd class="field-odd"><p>handles both .data and .data_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_large_uncertainty">
<code class="sig-name descname">find_large_uncertainty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma_thresold</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_large_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find dates with large uncertainty and flag them as outliers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_threshold</strong> – value (mm) for a date to be flagged.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
<li><p><strong>lcomponent</strong> – list of components to be checked. default = ‘NE’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_offsets">
<code class="sig-name descname">find_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">n_max_offsets</span><span class="o">=</span><span class="default_value">9</span></em>, <em class="sig-param"><span class="n">conf_level</span><span class="o">=</span><span class="default_value">95</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple empirical procedure to find offsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> – threshold value for offset preliminary detection</p></li>
<li><p><strong>n_max_offset</strong> – maximum number of offsets to be detected simultaneously</p></li>
<li><p><strong>conf_level</strong> – confidence level for a suspected offset to be accepted</p></li>
<li><p><strong>lcomponent</strong> – components used for offset detection</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts instance with offsets_dates and outliers now populated</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_offsets_edge_filter">
<code class="sig-name descname">find_offsets_edge_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">search_lbda</span><span class="o">=</span><span class="default_value">[3, 5, 7, 10, 20, 50, 100, 200, 300]</span></em>, <em class="sig-param"><span class="n">delta_day</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">eq_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_offsets_edge_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_offsets_t_scan">
<code class="sig-name descname">find_offsets_t_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">250</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_offsets_t_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outlier_around_date">
<code class="sig-name descname">find_outlier_around_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">conf_level</span><span class="o">=</span><span class="default_value">95</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outlier_around_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an outlier around a given date 
returns the index of the outlier, returns [] if no outlier found
:param date       : given date
:param conf_level : confidence level for F_ratio test of outlier significance (default 95%%)
:param n          : number of dates either sides of date (default n=3)
:param lcomponent : components ‘N’,’E’,’U’,’NE’,’NEU’ (default ‘NE’)</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_and_offsets_through_differentiation">
<code class="sig-name descname">find_outliers_and_offsets_through_differentiation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">th</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_and_offsets_through_differentiation" title="Permalink to this definition">¶</a></dt>
<dd><p>find outliers and offsets using differenciation</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_by_RMS_ts">
<code class="sig-name descname">find_outliers_by_RMS_ts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ndays</span><span class="o">=</span><span class="default_value">7</span></em>, <em class="sig-param"><span class="n">th_detection</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">th_rejection</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_by_RMS_ts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Find index of outliers in a time series, populate self.outliers.</dt><dd><ul class="simple">
<li><p>rms time series are first calculated over ndays</p></li>
<li><p>time windows are kept for further inspection if rms(t) &gt; th_detection * median(rms(ts))</p></li>
<li><p>for each anomalous time windows, differentiate positions, find the max</p></li>
<li><p>test whether it is a true outlier (differentiated(t) &gt; th_rejection * median(differentiated))</p></li>
</ul>
</dd>
<dt>output:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_by_residuals">
<code class="sig-name descname">find_outliers_by_residuals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'detrend_seasonal'</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_by_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Find index of outliers by trendline/trendline_annual/trendline_seasonal (the complete model)
Then the outliers are detected if their residuals are greater than th_rejection*standard_deviation</p>
<dl class="simple">
<dt>output:</dt><dd><p>Add the list of outlier index into self.outliers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_percentage">
<code class="sig-name descname">find_outliers_percentage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">percentage</span><span class="o">=</span><span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_percentage" title="Permalink to this definition">¶</a></dt>
<dd><p>detrend a time series and
ranks the residuals by increasing absolute value
populate the outliers with the x % largest ones on each component</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_simple">
<code class="sig-name descname">find_outliers_simple</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_simple" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_sliding_window">
<code class="sig-name descname">find_outliers_sliding_window</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">automatic</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_sliding_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Find outliers using sliding windows</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_vondrak">
<code class="sig-name descname">find_outliers_vondrak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">fc</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NE'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_vondrak" title="Permalink to this definition">¶</a></dt>
<dd><p>Find outliers using a Vondrak filter</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_time_offsets">
<code class="sig-name descname">find_time_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">option</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ndays</span><span class="o">=</span><span class="default_value">7</span></em>, <em class="sig-param"><span class="n">th_detection_rms</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">th_detection_offset</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_time_offsets" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Find the time of suspected offsets by rms time series calculated over ndays
Then check the time of offsets: if one offset is too small/None then it is removed
input:</p>
</div></blockquote>
<ul class="simple">
<li><p>ndays: number of positions in the windows. rms time series are calculated over ndays.</p></li>
<li><p>th_detection_rms: the threshold for detecting the anomalous windows rms(t) &gt; th_detection_rms*median(rms(ts)).</p></li>
<li><dl class="simple">
<dt>th_detection_offset: the threshold for detecting the offsets,</dt><dd><p>for each anomalous time windows, differentiate positions
then test whether it is a suspected offset (differentiated(t) &gt; threshold * median(differentiated))</p>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><p>output:</p>
<blockquote>
<div><p>add the time of offsets in to self.offsets</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.force_daily">
<code class="sig-name descname">force_daily</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.force_daily" title="Permalink to this definition">¶</a></dt>
<dd><p>force a time series to be daily with dates at 12:00:00 of every day</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.frame">
<code class="sig-name descname">frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frame</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a time series according to an Euler pole
Returns a new Gts instance</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.get_coseismic">
<code class="sig-name descname">get_coseismic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_date</span></em>, <em class="sig-param"><span class="n">window_days</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sample_after</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.get_coseismic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get coseismic displacement at a given date.
Coseismic displacement is estimated as the position difference between the median of window_days before 
the earthquake date and the median of sample_after samples after the earthquake date.</p>
<p>note: only median method implemented</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.get_unr">
<code class="sig-name descname">get_unr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">site</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.get_unr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a time series from <a class="reference external" href="http://geodesy.unr.edu/gps_timeseries/txyz/IGS14/">http://geodesy.unr.edu/gps_timeseries/txyz/IGS14/</a> in PYACS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site</strong> – 4-letters code</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print various informations about the time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.insert_gts_data">
<code class="sig-name descname">insert_gts_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gts</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.insert_gts_data" title="Permalink to this definition">¶</a></dt>
<dd><p>insert data (and/or) .data_xyz of a gts into the current gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gts</strong> – tie series to be inserted</p></li>
<li><p><strong>in_place</strong> – boolean, if True add_obs to the current Gts, if False, returns a new Gts</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts or the modified Gts if in_place</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.local_offset_robust">
<code class="sig-name descname">local_offset_robust</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.local_offset_robust" title="Permalink to this definition">¶</a></dt>
<dd><p>estimate a local offset (no velocity) with a robust method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of dates before and after the dates used in the estimation</p></li>
</ul>
</dd>
</dl>
<p>:return : a 1D numpy array with [date, north, east, up, s_north, s_east, s_up]</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>the offsets are estimated using the difference between the median position before and after the earthquake using i days</p>
</dd>
</dl>
<p>for all i &lt;=n. Then the median of the estimates is returned.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.make_dynamic_apr">
<code class="sig-name descname">make_dynamic_apr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">apr</span></em>, <em class="sig-param"><span class="n">time_step</span><span class="o">=</span><span class="default_value">30.0</span></em>, <em class="sig-param"><span class="n">pos_tol</span><span class="o">=</span><span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">gap</span><span class="o">=</span><span class="default_value">20.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.make_dynamic_apr" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an apr file for GAMIT
The created apr file has no velocity, but a series of coordinates at different time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apr</strong> – apr file (Globk format)</p></li>
<li><p><strong>time_step</strong> – time step for writing dates (default 30 days)</p></li>
<li><p><strong>pos_tol</strong> – position tolerance. If exceeded, a new date will be written. (default 0.03 m)</p></li>
<li><p><strong>dates</strong> – a list of dates in decimal years where writing will be forced</p></li>
<li><p><strong>gap</strong> – gap in days. If there is no data during a duration greater than gap, then observation is forced to be included and tested against pos_tol</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.make_model">
<code class="sig-name descname">make_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">option</span><span class="o">=</span><span class="default_value">'detrend'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">loutlier</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.make_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate time series model parameters using least squares 
input: data: Gts format
option are: ‘detrend’/’detrend_annual’/’detrend_seasonal’
output: new Gts object: time series is now the residuals wrt to the model and its associated values (vel, annual, semi-annual etc)</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.median_filter">
<code class="sig-name descname">median_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.median_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a filtered time series using scipy.signal.medfilt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – size of the median filter window (must be odd)</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>the filter is applied to .data and .data_xyz is set to None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.minimum_component">
<code class="sig-name descname">minimum_component</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mask_period</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">fcut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Q</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.minimum_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum component filtering for Gts.</p>
<p>Minimum component filtering is useful for determining the background
component of a signal in the presence of spikes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_periods</strong> – periods (list or list of lists) which should be ignored for smoothing</p></li>
<li><p><strong>p</strong> – integer (optional). polynomial degree to be used for the fit (default = 1)</p></li>
<li><p><strong>fcut</strong> – float (optional). the cutoff frequency for the low-pass filter.  Default value is f_nyq / sqrt(N)</p></li>
<li><p><strong>Q</strong> – float (optional). the strength of the low-pass filter.  Larger Q means a steeper cutoff. default value is 0.1 * fcut</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>This code follows the procedure explained in the book
“Practical Statistics for Astronomers” by Wall &amp; Jenkins book, as
well as in Wall, J, A&amp;A 122:371, 1997</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.mmodel">
<code class="sig-name descname">mmodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.mmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a modeled time series from the parameters read in self</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.neu2xyz">
<code class="sig-name descname">neu2xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">corr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.neu2xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>populates .data_xyz from .data
requires X0,Y0,Z0 attributes to be set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr</strong> – if True, then standard deviation and correlations will also be calculated</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.np_datetime_2_eq_time">
<code class="sig-name descname">np_datetime_2_eq_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">leap_sec</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">eq_time</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.np_datetime_2_eq_time" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a hash of python datetime.datetime object and return a numpy array of seconds with respect to eq_time
if the input array is in GPS time, providing leap_sec correct for the GPS_time - UTC delta</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leap_sec</strong> – number of seconds between GPS_time - UTC delta (leap_sec=17 that is GPS is ahead of UTC by 17 seconds on 13/02/2016)</p></li>
<li><p><strong>eq_time</strong> – time of earthquake as a python datetime.datetime object (in UTC)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.np_yyyy_mm_dd_hh_mm_ss_2_datetime">
<code class="sig-name descname">np_yyyy_mm_dd_hh_mm_ss_2_datetime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.np_yyyy_mm_dd_hh_mm_ss_2_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a numpy array including year month mday hour minute sec to an array of python datetime.datetime object
returns a hash</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.np_yyyy_mm_dd_hh_mm_ss_2_decyear">
<code class="sig-name descname">np_yyyy_mm_dd_hh_mm_ss_2_decyear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.np_yyyy_mm_dd_hh_mm_ss_2_decyear" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a numpy array including year month mday hour minute sec to decimal year
returns a 1D array</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loffset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">loutliers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">date</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">yaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yupaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xticks_minor_locator</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">['N', 'E', 'U']</span></em>, <em class="sig-param"><span class="n">error_scale</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">lperiod</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">lvline</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">save_dir_plots</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">'mm'</span></em>, <em class="sig-param"><span class="n">date_unit</span><span class="o">=</span><span class="default_value">'decyear'</span></em>, <em class="sig-param"><span class="n">date_ref</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">superimposed</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lcolor</span><span class="o">=</span><span class="default_value">['r', 'g', 'c', 'm', 'y', 'k', 'b']</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">legend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">set_zero_at_date</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">grid</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">xlabel_fmt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a plot of a North-East-Up time series and related info (offsets, outliers) using Matplotlib
Coordinates of the time series are assumed to be in meters
default plots units will be mm; Use unit=’m’ to get meters instead</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> – string to be added to the site name as a plot title</p></li>
<li><p><strong>loffset</strong> – boolean
print a dash vertical line at offset dates</p></li>
<li><p><strong>loutliers</strong> – boolean
print outliers</p></li>
<li><p><strong>verbose</strong> – boolean
verbose mode</p></li>
<li><p><strong>date</strong> – [sdate,edate]
start and end date for plots
sdate and edate in decimal years if date_unit is either ‘decyear’ or ‘cal’, or in days if date_unit is ‘days’</p></li>
<li><p><strong>yaxis</strong> – [min_y,max_y]
min and max value for the yaxis
if not provided automatically adjusted</p></li>
<li><p><strong>yupaxis</strong> – same as yaxis but applies to the up component only</p></li>
<li><p><strong>xticks_minor_locator</strong> – where xticks_minor_locator will be placed. Float when date_unit is ‘decyear’ or ‘days’, a string ‘%Y’,’%m’,’%d’ is date_unit is ‘cal’.</p></li>
<li><p><strong>lcomponent</strong> – list of components to be plotted (default =[‘N’,’E’,’U’])</p></li>
<li><p><strong>error_scale</strong> – scaling factor for error bars (default = 1.0, 0 means no error bar)</p></li>
<li><p><strong>lperiod</strong> – list of periods to be drawn in background (color=light salmon)</p></li>
<li><p><strong>lvline</strong> – list of dates where vertical lines will be drawn in background (color=green)</p></li>
<li><p><strong>save_dir_plots</strong> – directory used for saving the plots</p></li>
<li><p><strong>save</strong> – name, save the plot into name, if simply True an automatic name is given</p></li>
<li><p><strong>show</strong> – boolean, is True show the plot</p></li>
<li><p><strong>unit</strong> – ‘m’,’cm’,’mm’, default=’mm’</p></li>
<li><p><strong>date_unit</strong> – ‘decyear’ or ‘cal’ or ‘days’, default=’decyear’</p></li>
<li><p><strong>date_ref</strong> – reference date, default=0.0</p></li>
<li><p><strong>center</strong> – boolean, if True the y_axis is centered around the mean value for the plotted period</p></li>
<li><p><strong>superimposed</strong> – if a gts is provided, it is superimposed to the master, default=None</p></li>
<li><p><strong>lcolor</strong> – color list used for the superimposed time series, default=[‘r’,’g’,’c’,’m’,’y’,’k’,’b’]</p></li>
<li><p><strong>label</strong> – label for superimposed time series to be displayed in legend, default=None</p></li>
<li><p><strong>legend</strong> – boolean. Set true to display label for superimposed time series, default=False</p></li>
<li><p><strong>set_zero_at_date</strong> – date at which the master and superimposed gts will be equal (default=None). date can also be a list with [date,offset_north,offset_east,offset_up]</p></li>
<li><p><strong>plot_size</strong> – plot size as a tuple. Default, best guess.</p></li>
<li><p><strong>grid</strong> – boolean</p></li>
<li><p><strong>info</strong> – title to appear in time series subplots</p></li>
<li><p><strong>**kwargs</strong> – <p>any argument to be passed to  matplotlib.pyplot.errorbar</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>The list of kwargs are:</p>
</dd>
</dl>
<p>{  ‘linewidth’ : 0,       ‘marker’ : marker_main_symbol ,       ‘markersize’ : marker_main_size,        ‘markerfacecolor’ : marker_main_color,       ‘markeredgecolor’ : marker_main_color,       ‘markeredgewidth’ : marker_main_colorlw,       ‘ecolor’ : error_bar_color,       ‘elinewidth’ : error_bar_linewidth,       ‘capsize’ : error_bar_capsize }</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.pwlf">
<code class="sig-name descname">pwlf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">component</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.pwlf" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a piecewise approximation of a time series. Since it the routine is 1D, the component E,N, or U needs to be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> – component used for the decomposition. Must be ‘E’,’N’ or ‘U’</p></li>
<li><p><strong>n</strong> – number of segments</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p>if False, the predicted time series is returned. If True, then a list of dates is returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_cats_file">
<code class="sig-name descname">read_cats_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_cats_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read cats files in a directory and actually loads the time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_eq_rename">
<code class="sig-name descname">read_eq_rename</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_rename</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_eq_rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the information for the current site (code) from an eq_rename globk file.</p>
<p>Populates loutliers and offsets_dates
Found excluded periods in the eq_rename file are added to loutliers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_rename</strong> – eq_rename (globk format) file to be read</p></li>
<li><p><strong>in_place</strong> – boolean. If True then the Gts instance is modified, if False the Gts instance is preserved and a new Gts instance is return</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_kenv">
<code class="sig-name descname">read_kenv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ifile</span></em>, <em class="sig-param"><span class="n">date_type</span><span class="o">=</span><span class="default_value">'jd'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_kenv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read kenv file (magnet) format for time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_lon_lat">
<code class="sig-name descname">read_lon_lat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gmt_file</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_lon_lat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a gmt psvelo file and populates Gts.lon &amp; Gts.lat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmt_file</strong> – gmt psvelo file</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_mb_file">
<code class="sig-name descname">read_mb_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_mb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read GAMIT/GLOBK mb_files in a directory and actually loads the time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_offset_dates">
<code class="sig-name descname">read_offset_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offset_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_offset_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an offset file and populates offsets_dates (pyacs format) attribute of the current Gts instance.
format is simply a code dates. dates can be any format read by pyacs.guess_date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>offset_file</strong> – offset_file to be read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pos">
<code class="sig-name descname">read_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Read GAMIT/GLOBK PBO pos file in a directory and actually loads the time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsdir</strong> – directory of pos file</p></li>
<li><p><strong>tsfile</strong> – pos file to be loaded</p></li>
<li><p><strong>xyz</strong> – reads xyz sx sy sz corr_xy corr_xz corr_yz columns</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Return Nothing</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Nothing</strong> – </p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Since a pos file includes (almost) all the information, data, code, X0,Y0,Z0,t0 will be populated</p>
</dd>
</dl>
<p>If file=None, then read_pos will look for a file named CODE*.pos</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pride">
<code class="sig-name descname">read_pride</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pride" title="Permalink to this definition">¶</a></dt>
<dd><p>Read PRIDE-PPPAR kinematic result file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsdir</strong> – directory of pride-pppar kinematic files</p></li>
<li><p><strong>tsfile</strong> – pride-pppar kinematic file to be loaded</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Return Nothing</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Nothing</strong> – </p>
</dd>
</dl>
<p>If file=None, then read_pride will look for a files named kin_*code</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pride_pos">
<code class="sig-name descname">read_pride_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pride_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Read PRIDE-PPPAR static result file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsdir</strong> – directory of pride-pppar pos static files</p></li>
<li><p><strong>tsfile</strong> – pride-pppar pos static file to be loaded</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>If file=None, then read_pride will look for a files named pos_*code</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_tdp">
<code class="sig-name descname">read_tdp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_tdp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tdp (Gipsy kinematics provided by Cedric Twardzik 17/04/2018) format for time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_track_NEU">
<code class="sig-name descname">read_track_NEU</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leap_sec</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">eq_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_track_NEU" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a GAMIT/GLOBK Track output file generated with the option out_type NEU
in this case dates are seconds
by default the seconds are with respect to the first epoch of measurements
If option leap_sec is provided with a value &gt; 0.0, then GPS time is corrected for the difference between GPTS time and UTC 
If eq_time is provided, it is assumed to be UTC. Expected format is YYYY:MM:MD:HH:MM:SS.S</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.realistic_sigma">
<code class="sig-name descname">realistic_sigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">option</span><span class="o">=</span><span class="default_value">'tsfit'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.realistic_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates realistic sigmas on velocity components
:param option:</p>
<blockquote>
<div><ul class="simple">
<li><p>tsfit: globk T. Herring realistic sigma</p></li>
<li><p>cats_pl: CATS estimates with noise type estimated (i.e. –model=pl:)</p></li>
<li><p>cats_seasonal_pl: CATS estimates with seasonal terms and noise type estimated (i.e. –model=pl: –sinusoid=1y1)</p></li>
<li><p>cats_flicker: CATS estimates assuming flicker noise (i.e. –model=pl:k-1)</p></li>
<li><p>cats_seasonal_flicker: CATS estimates with seasonal terms and assuming flicker noise (i.e. –model=pl:k-1 –sinusoid=1y1)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_outliers">
<code class="sig-name descname">remove_outliers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>removes outliers provided in self.outliers
return a new Gts without the outliers
if in_place = True then self has the outliers removed as well (in _place)</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_pole">
<code class="sig-name descname">remove_pole</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pole</span></em>, <em class="sig-param"><span class="n">pole_type</span><span class="o">=</span><span class="default_value">'euler'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_pole" title="Permalink to this definition">¶</a></dt>
<dd><p>remove velocity predicted by an Euler pole or a rotation rate vector from a time series
pole is a 1D array with 3 values
requires self.lon &amp; self.lat attributes to have been filled before 
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_velocity">
<code class="sig-name descname">remove_velocity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vel_neu</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>remove velocity from a time series
vel_neu is a 1D array of any arbitrary length, but with the velocities (NEU) to be removed in the first 3 columns
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.reorder">
<code class="sig-name descname">reorder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>reorder data and/or data_xyz by increasing dates
always in place</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – verbose mode</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">angle</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>rotates the axis by an angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angle</strong> – angle in decimal degrees clockwise</p>
</dd>
</dl>
<p>if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.save_apr">
<code class="sig-name descname">save_apr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">apr</span></em>, <em class="sig-param"><span class="n">epoch</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.save_apr" title="Permalink to this definition">¶</a></dt>
<dd><p>save results of a Gts analysis in globk format apr file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apr</strong> – apr file (Globk format)</p></li>
<li><p><strong>epoch</strong> – epoch in decimal year for coordinates in apr</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
<li><p><strong>exluded_periods</strong> – periods to be excluded</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gts instance</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>following Globk’s convention, site will be named XXXX_1PS, XXXX_2PS etc between offset dates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.save_eq_rename">
<code class="sig-name descname">save_eq_rename</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_rename</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.save_eq_rename" title="Permalink to this definition">¶</a></dt>
<dd><p>save results of a Gts analysis in globk format eq_rename</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_rename</strong> – output eq_rename file (Golbk format)</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
<li><p><strong>exluded_periods</strong> – periods to be excluded</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.save_offsets">
<code class="sig-name descname">save_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ofile</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">comment</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">up</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.save_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends offsets values to a given text file (gmt psvelo format)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ofile</strong> – output offset file</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
<li><p><strong>comment</strong> – comment as a string. ‘# ‘ is pre-prended to comment if not provided</p></li>
<li><p><strong>up</strong> – boolean. If True, then Ve, SVe and SVen are set to 0 and Vu and Vu are written as 4-th and 6-th fields</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.save_velocity">
<code class="sig-name descname">save_velocity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gmt_file</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">comment</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">up</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.save_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends velocity estimates (with uncertainties) to a gmt psvelo file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmt_file</strong> – output gmt psvelo file (will append if gmt_file already exists)</p></li>
<li><p><strong>verbose</strong> – verbose mode (boolean)</p></li>
<li><p><strong>comment</strong> – comment as a string. ‘# ‘ is pre-prended to comment if not provided</p></li>
<li><p><strong>up</strong> – boolean. If True, then Ve, SVe and SVen are set to 0 and Vu and Vu are written as 4-th and 6-th fields</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current Gts instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.savitzky_golay">
<code class="sig-name descname">savitzky_golay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">polyorder</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">deriv</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">delta</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'interp'</span></em>, <em class="sig-param"><span class="n">cval</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.savitzky_golay" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a filtered time series using scipy.signal.savgol_filter</p>
<p>See documentation for the filter parameters.
<a class="reference external" href="http://https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html#scipy.signal.savgol_filter">http://https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html#scipy.signal.savgol_filter</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.set_zero_at_date">
<code class="sig-name descname">set_zero_at_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.set_zero_at_date" title="Permalink to this definition">¶</a></dt>
<dd><p>make a translation of a time series, setting to 0 at a given date
if the provided date does not exist, uses the next date available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>offset</strong> – an offset (in mm) to be added. Could be a float, a list or 1D numpy array with 3 elements</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.sigma_cats">
<code class="sig-name descname">sigma_cats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">'k-1'</span></em>, <em class="sig-param"><span class="n">seasonal</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.sigma_cats" title="Permalink to this definition">¶</a></dt>
<dd><p>runs CATS for getting realistic sigma</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.sigma_vel_tsfit">
<code class="sig-name descname">sigma_vel_tsfit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.sigma_vel_tsfit" title="Permalink to this definition">¶</a></dt>
<dd><p>runs tsfit for getting realistic sigma</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.smooth">
<code class="sig-name descname">smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth a time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.spline">
<code class="sig-name descname">spline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smoothing</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">degree</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">date</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.spline" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smoothing</strong> – Positive smoothing factor used to choose the number of knots. Number of knots will be increased</p>
</dd>
</dl>
<p>until the smoothing condition is satisfied:</p>
<p>sum((w[i] * (y[i]-spl(x[i])))**2, axis=0) &lt;= s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degree</strong> – Degree of the smoothing spline. Must be &lt;= 5. Default is k=3, a cubic spline.</p></li>
<li><p><strong>date</strong> – 1D array of interpolation dates in decimal year, or ‘day’ for every day. defualt None will interpolate</p></li>
</ul>
</dd>
</dl>
<p>at data date only.
:return: new gts instance</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.substract_ts">
<code class="sig-name descname">substract_ts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.substract_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>substract the ts provided as argument to the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – time series to be substracted as a Gts instance</p></li>
<li><p><strong>tol</strong> – date tolerance to decide whether two dates are identical in both time series. default = 1/4 day</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.substract_ts_daily">
<code class="sig-name descname">substract_ts_daily</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.substract_ts_daily" title="Permalink to this definition">¶</a></dt>
<dd><p>substract the ts provided as argument to the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – time series to be substracted as a Gts instance</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>this method assumes daily time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.suspect_offsets">
<code class="sig-name descname">suspect_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">n_max_offsets</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.suspect_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to find offsets in a time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.suspect_offsets_mf">
<code class="sig-name descname">suspect_offsets_mf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">n_max_offsets</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.suspect_offsets_mf" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to find offsets in a time series using a median filter</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.test_offset_significance">
<code class="sig-name descname">test_offset_significance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">conf_level</span><span class="o">=</span><span class="default_value">95</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'local'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.test_offset_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>test the significance of an offset</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>date        : date of the offset to be tested</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>conf_level  : confidence level in percent (default=95)</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>lcomponent  : component to be tested (default=’NE’)</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>mode        : choose among ‘local’,’detrend’,’detrend_seasonal’ to test significance</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>verbose     : verbose mode</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>: True if significant, else False</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.test_offsets">
<code class="sig-name descname">test_offsets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.test_offsets" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Test the offset:</dt><dd><ul class="simple">
<li><p>delete the small offset (1mm for East/North, 2mm for Up)</p></li>
<li><p>then make a F ratio test</p></li>
<li><p>re-check to delete the small offsets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.to_pandas_df">
<code class="sig-name descname">to_pandas_df</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.to_pandas_df" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas DataFrame</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>uncertainties are not imported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.trajectory">
<code class="sig-name descname">trajectory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">offset_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">eq_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">H_fix</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">H_constraints</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">H_bounds</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the parameters of a (non-linear) trajectory model for a Geodetic Time Series.
The trajectory model is:</p>
<p>y(t) =</p>
<p>trend : trend_cst + trend * ( t - t0 ) +</p>
<p>annual: a_annual * cos( 2*pi + phi_annual ) +</p>
<p>semi-annual: a_semi_annual * cos( 2*pi + phi_semi_annual ) +</p>
<p>offset : Heaviside( t - t_offset_i ) * offset_i +</p>
<p>post-seismic_deformation as decaying log (psd_log):   psd_eq_i * np.log( 1 + Heaveside( t - eq_i )/tau_i )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_type</strong> – string made of the key-word the parameters to be estimated.</p>
</dd>
</dl>
<p>Key-word parameters are</p>
<p>‘trend’,’annual’,’semi-annual’,’seasonal’,’offset’,’psd_log’.</p>
<p>‘trend-seasonal-offset-psd_log’ will do the full trajectory model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset_dates</strong> – a list of offset_dates in decimal year</p></li>
<li><p><strong>eq_dates</strong> – a list of earthquake dates for which post-seismic deformation (psd_log) will be estimated</p></li>
<li><p><strong>H_fix</strong> – a dictionary including the name of the parameter to be hold fixed and the value.</p></li>
</ul>
</dd>
</dl>
<p>For instance to impose the co-seismic offset (North-East-Up) and relaxation time of 100 days for the
first earthquake use:</p>
<p>H_fix = { ‘psd_log_offset_00’:[10., 15., 0.] , ‘psd_log_tau_00’:[100., 100., 100.]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>H_constraints</strong> – a dictionary including the name of the parameter to be constrained.</p>
</dd>
</dl>
<p>For instance to impose a 50 days constraints around 500 days
on the relaxation time of the second earthquake for all NEU components use: H_fix = { ‘psd_log_tau_01’:[[500.,50],
[500.,50] , [500.,50]]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>H_bounds</strong> – a dictionary including the bounds.</p>
</dd>
</dl>
<p>For instance to impose a relaxation time for the third earthquake to be in the range
of 2 to 3 years, for all NEU components use: H_bounds = { ‘psd_log_tau_02’:[[2*365.,3*365.], [[2*365.,3*365.] ,
[[2*365.,3*365.]]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> – string , component for which the trajectory model will be estimated.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Unlike most pyacs.gts functions, trajectory returns 4 elements: the results as a dictionary, the model Gts,</p>
</dd>
</dl>
<p>the residual Gts and a Gts with model predictions at every day.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.tv_l2_filter">
<code class="sig-name descname">tv_l2_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lbda</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.tv_l2_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Gts filter using a L2 total variation filter.
The signal is assumed to be detrended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lbda</strong> – lambda parameter</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
<dt class="field-odd">Reference</dt>
<dd class="field-odd"><p><a class="reference external" href="https://github.com/albarji/proxTV">https://github.com/albarji/proxTV</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.vondrak">
<code class="sig-name descname">vondrak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fc</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.vondrak" title="Permalink to this definition">¶</a></dt>
<dd><p>returned a filtered Gts using a Vondrak filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – cutoff frequence in cycle per year</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.wiener">
<code class="sig-name descname">wiener</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">my_size</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">noise</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.wiener" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a filtered time series using scipy.signal.wiener</p>
<p>See documentation for the filter parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.write_cats">
<code class="sig-name descname">write_cats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_key</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.write_cats" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a file for a cats analysis
if offsets_dates is not None then offsets are added at the beginning of the file</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.write_mb_file">
<code class="sig-name descname">write_mb_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span></em>, <em class="sig-param"><span class="n">add_key</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.write_mb_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.write_pos">
<code class="sig-name descname">write_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span></em>, <em class="sig-param"><span class="n">add_key</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">force</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.write_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a time series in GAMIT/GLOBK PBO pos format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idir</strong> – output directory</p></li>
<li><p><strong>add_key</strong> – if not blank then the output pos file will be CODE_add_key.pos, CODE.pos otherwise.</p></li>
<li><p><strong>force</strong> – set force to ‘data’ or ‘data_xyz’ to force pos to be written from .data or .data_xyz</p></li>
</ul>
</dd>
<dt class="field-even">Note1</dt>
<dd class="field-even"><p></p></dd>
</dl>
<p>default behaviour (force = None)
if data and data_xyz are not None, then print them independently
if there are data only, then uses X0,Y0,Z0 to write data_xyz
if there are data_xyz only, recreate data and write it</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.wrms">
<code class="sig-name descname">wrms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.wrms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the wrms</p>
<dl class="field-list simple">
<dt class="field-odd">Return wrms</dt>
<dd class="field-odd"><p>return(np.array([wrms_n,wrms_e,wrms_up]))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.xyz2neu">
<code class="sig-name descname">xyz2neu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">corr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ref_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.xyz2neu" title="Permalink to this definition">¶</a></dt>
<dd><p>populates neu (data) using xyz (data_xyz)
lon, lat and h will also be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr</strong> – if True, then standard deviation and correlations will also be calculated</p></li>
<li><p><strong>ref_xyz</strong> – [X,Y,Z] corresponding to the 0 of the local NEU frame. If not provided, the first position is used as a reference</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>this method is always in place</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyacs.gts.Sgts.html" class="btn btn-neutral float-right" title="pyacs.gts.Sgts module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pyacs.gts.lib.trajectory.html" class="btn btn-neutral float-left" title="pyacs.gts.lib.trajectory module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016, Jean-Mathieu Nocquet IRD/Geoazur

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>